---
import { useTranslation, slugify } from "@/i18n";
import { translations, defaultLang } from "@/i18n/config";
import Layout from "@/layouts/Layout.astro";

export async function getStaticPaths() {
  const paths: any[] = [];
  for (const lang of Object.keys(translations)) {
    const t = await (translations as any)[lang]();
    const aboutSlug = slugify(String(t?.nav?.about || "about"));
    paths.push({ params: { lang, slug: aboutSlug } });
  }
  return paths;
}

const lang = Astro.params.lang ?? defaultLang;
const slug = Astro.params.slug as string | undefined;
const t = await useTranslation(lang as any);

const aboutSlug = slugify(String(t?.nav?.about || "about"));
const isAbout = slug === aboutSlug;
---

{isAbout ? (
  <Layout title="About">
    <h1>{t.nav.about}</h1>
  </Layout>
) : (
  <Layout title="Not found">
    <main>
      <h1>404 â€” Not found</h1>
      <p>The requested page could not be found.</p>
    </main>
  </Layout>
)}
